!function(){"use strict";class e{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s,this.id=e._id,this._handleDeleteCard=i,this._handleLikeCard=r,this._isLiked=e.isLiked||!1}getCardId(){return this.id}getIsLiked(){return this._isLiked}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}setIsLiked(e){this._isLiked=e,this._renderLikes()}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._renderLikes(this._likeButton),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._setEventListeners(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__description-text").textContent=this._name,this._cardElement}}var t=class{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){return e.validity.valid?this._hideInputError(e):this._showInputError(e)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(e){e.classList.remove(this._inactiveButtonClass),e.disabled=!1}resetValidation(){this._toggleButtonState(this._inputEls,this._submitButton),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(e,t){this._hasValidInput(e)?this._enableButton(this._submitButton):this.disableButton()}_hasValidInput(e){return e.every((e=>e.validity.valid))}_setEventListeners(){this._inputEls=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(this._inputEls,this._submitButton),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputEls,this._submitButton)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=document.querySelector(".modal__close-button"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_open")||e.target.classList.contains("modal__close-button"))&&this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=Array.from(this._popupForm.querySelectorAll(".modal__input")),this._submitButton=this._popupForm.querySelector(".modal__save-button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}reset(){this._popupForm.reset(),this.close()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const r=document.querySelector(".profile__edit-button"),n=(document.querySelector("#profile-edit-modal"),document.querySelector(".profile__title")),o=document.querySelector(".profile__description"),a=(document.querySelector(".modal__input_type_name"),document.querySelector(".modal__input_type_description"),document.querySelector(".cards__list"),document.querySelector(".profile__add-button")),l=(document.querySelector("#newcards"),document.querySelector(".modal__input_type_title"),document.querySelector(".modal__input_type_link"),{}),d=document.querySelector("#profilePicture"),u=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._previewImage=this._popupElement.querySelector(".modal__image-preview"),this._previewImageTitle=this._popupElement.querySelector(".modal__title-preview")}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this._previewImage.src=t,this._previewImage.alt=e,this._previewImageTitle.textContent=e,super.open()}}({popupSelector:"#preview"});u.setEventListeners();const h=new i("#profile-edit-modal",(function(e){L((function(){return p.editUserData(e).then((e=>{E.modifyUserInfo(e)}))}),h)}));h.setEventListeners();const c=new i("#newcards",(function(e){L((function(){return p.addNewCard(e).then((e=>{v(e),l["newcard-form"].disableButton()}))}),c)}));c.setEventListeners();const _=new i("#pfpEdit",(function(e){L((function(){return p.editPfp(e).then((e=>{E.setUserPfp({avatar:e.avatar})}))}),_)}));_.setEventListeners();const m=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__save-button"),this._submitButtonText=this._submitButton.textContent}handleConfirm(e){this._handleConfirmSubmit=e}open(e,t){this._currentCard=e,this._cardId=t,super.open()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleConfirmSubmit()}))}showLoading(e){this._submitButton.textContent=e?"Loading...":"YES"}renderLoading(e,t="Saving..."){this._submitButton.textContent=e?t:this._submitButtonText}}("#confirm");m.setEventListeners();const p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getUserData(){return this._request(`${this.baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserData(e){return this._request(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})})}editPfp(e){return this._request(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})})}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{method:"GET",headers:this._headers})}addNewCard(e){return this._request(`${this.baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}addLike(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}removeLike(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"8d3dab07-3d12-4401-9299-225a306c1793","Content-Type":"application/json"}}),E=new class{constructor(e,t,s){this._displayedName=e,this._displayedDescription=t,this._pfpElement=s}getUserInfo(){return{name:this._displayedName.textContent,description:this._displayedDescription.textContent}}setUserInfo(e){this._displayedName.textContent=e.name,this._displayedDescription.textContent=e.description}modifyUserInfo(e){this._displayedName.textContent=e.name,this._displayedDescription.textContent=e.about}setUserPfp(e){this._pfpElement.src=e.avatar}}(n,o,d);function v(t){const s=new e(t,"#jscard-template",S,b,y).getView();f.addItem(s)}p.getInitialCards().then((e=>{const t=e.map((e=>v(e)));f.renderItems(t)})).catch((e=>{console.error(e)}));const f=new class{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._element=document.querySelector(t)}renderItems(e){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}({items:[],renderer:v},".cards__list");function b(e){m.open(),m.handleConfirm((()=>{m.renderLoading(!0),p.deleteCard(e.getCardId()).then((()=>{e.handleDeleteCard(),m.close()})).catch((e=>{console.error(e)})).finally((()=>{m.renderLoading(!1)}))}))}function L(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.renderLoading(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.renderLoading(!1)}))}function S(e,t){u.open(e,t)}function y(e){e.getIsLiked()?p.removeLike(e.getCardId()).then((()=>{e.setIsLiked(!1)})).catch((e=>{console.error(e)})):p.addLike(e.getCardId()).then((()=>{e.setIsLiked(!0)})).catch(console.error)}var g;p.getUserData().then((e=>{E.setUserInfo({name:e.name,description:e.about}),E.setUserPfp({avatar:e.avatar})})).catch((e=>{console.error(e)})),r.addEventListener("click",(()=>{const e=E.getUserInfo();h.setInputValues(e),l["profile-form"].resetValidation(),h.open()})),a.addEventListener("click",(()=>{c.open()})),d.addEventListener("click",(()=>{_.open()})),g={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(g.formSelector)).forEach((e=>{const s=new t(g,e),i=e.getAttribute("id");l[i]=s,s.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLN0ssWUFBVyxFQUFLLElBRXRCZ0ssTUFBTUUsUUFBUUMsTUFFckIsQ0FHMEJ0SixNQWhIMUJ3RixFQUNHa0MsY0FDQWhDLE1BQU1zQixJQUNMckIsRUFBU2lELFlBQVksQ0FBRTdLLEtBQU1pSixFQUFJakosS0FBTWlLLFlBQWFoQixFQUFJZSxRQUN4RHBDLEVBQVNNLFdBQVcsQ0FBRUMsT0FBUWMsRUFBSWQsUUFBUyxJQUU1Q2lELE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFJdEJ4RSxFQUFlOUYsaUJBQWlCLFNBQVMsS0FDdkMsTUFBTXNMLEVBQU96RSxFQUFTZ0QsY0FDdEJ0RCxFQUFhakIsZUFBZWdHLEdBQzVCcEYsRUFBZSxnQkFBZ0JwRCxrQkFDL0J5RCxFQUFhdEMsTUFBTSxJQUdyQmdDLEVBQVdqRyxpQkFBaUIsU0FBUyxLQUNuQytHLEVBQWE5QyxNQUFNLElBR3JCa0MsRUFBSW5HLGlCQUFpQixTQUFTLEtBQzVCa0gsRUFBUWpELE1BQU0sSUF5RlUvQyxFRHBLSixDQUNwQkcsYUFBYyxlQUNkRSxjQUFlLGdCQUNmRSxxQkFBc0Isc0JBQ3RCRSxvQkFBcUIsOEJBQ3JCRSxnQkFBaUIsMEJBQ2pCRSxXQUFZLHdCQytKS2dELE1BQU1DLEtBQUt0RSxTQUFTMkMsaUJBQWlCbkMsRUFBT0csZUFDcEQ0QixTQUFTOUIsSUFDaEIsTUFBTW9LLEVBQVksSUFBSUMsRUFBY3RLLEVBQVFDLEdBQ3RDc0ssRUFBV3RLLEVBQVl1SyxhQUFhLE1BQzFDeEYsRUFBZXVGLEdBQVlGLEVBQzNCQSxFQUFVL0gsa0JBQWtCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgaGFuZGxlTGlrZUNhcmRcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLmlkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkIHx8IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaWQ7XHJcbiAgfVxyXG5cclxuICBnZXRJc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIC8vZ2V0IGNhcmQgdmlld1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcyh0aGlzLl9saWtlQnV0dG9uKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICAvL3NldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZXNjcmlwdGlvbi10ZXh0XCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fbmFtZTtcclxuICAgIC8vcmV0dXJuIHRoZSBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oYnV0dG9uKSB7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRFbHMsIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgX3N1Ym1pdEJ1dHRvbikge1xyXG4gICAgaWYgKHRoaXMuX2hhc1ZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24odGhpcy5fc3VibWl0QnV0dG9uKTtcclxuICAgIH0gZWxzZSB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIF9oYXNWYWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5ldmVyeSgoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVscywgdGhpcy5fc3VibWl0QnV0dG9uKTtcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVscywgdGhpcy5fc3VibWl0QnV0dG9uKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAvL29wZW5zXHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIC8vY2xvc2VcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5cIikgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuLy8gRWxlbWVudHNcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgbmV3Q2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdjYXJkc1wiKTtcclxuZXhwb3J0IGNvbnN0IG5ld0NhcmROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IG5ld0NhcmRMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX2xpbmtcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBjYXJkU2VjdGlvbjogXCIuY2FyZHNfX2xpc3RcIixcclxuICBjYXJkVGVtcGxhdGU6IFwiI2pzY2FyZC10ZW1wbGF0ZVwiLFxyXG59O1xyXG5leHBvcnQgY29uc3QgcGZwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlUGljdHVyZVwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREYXRhID0ge1xyXG4gIG5hbWU6IFwiQ2FyZCBOYW1lXCIsXHJcbiAgbGluazogXCJodHRwczovL2V4YW1wbGUuY29tL2ltYWdlLmpwZ1wiLFxyXG4gIGlkOiBcImNhcmQxMjNcIixcclxufTtcclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY29uZmlnLFxyXG4gIHByb2ZpbGVFZGl0QnRuLFxyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICBjYXJkQWRkQnRuLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG4gIHNlbGVjdG9ycyxcclxuICBwZnAsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybVwiO1xyXG5cclxuLy9FbGVtZW50c1xyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHsgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlld1wiIH0pO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlU3VibWl0XHJcbik7XHJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNuZXdjYXJkc1wiLCBhZGROZXdDYXJkU3VibWl0KTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGVkaXRQZnAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwZnBFZGl0XCIsIGVkaXRQZnBTdWJtaXQpO1xyXG5lZGl0UGZwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtKFwiI2NvbmZpcm1cIik7XHJcbmNvbmZpcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI4ZDNkYWIwNy0zZDEyLTQ0MDEtOTI5OS0yMjVhMzA2YzE3OTNcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwZnApO1xyXG5cclxuLy9pbml0YWxpemF0aW9uXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIFwiI2pzY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlQ2FyZEltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG4gICAgaGFuZGxlTGlrZUNhcmRcclxuICApO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZXRWaWV3KCk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbn1cclxuLy9yZW5kZXIgbmV3Y2FyZHNcclxuZnVuY3Rpb24gY2FyZExpc3REYXRhKCkge1xyXG4gIHJldHVybiBhcGlcclxuICAgIC5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkYXRhLm1hcCgoY2FyZERhdGEpID0+IGNyZWF0ZUNhcmQoY2FyZERhdGEpKTtcclxuICAgICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jYXJkTGlzdERhdGEoKTtcclxuXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IFtdLFxyXG4gICAgcmVuZGVyZXI6IGNyZWF0ZUNhcmQsXHJcbiAgfSxcclxuICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cclxuKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRVc2VyRGF0YSgpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiByZXMubmFtZSwgZGVzY3JpcHRpb246IHJlcy5hYm91dCB9KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJQZnAoeyBhdmF0YXI6IHJlcy5hdmF0YXIgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVBvcHVwLnNldElucHV0VmFsdWVzKGluZm8pO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuY2FyZEFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxucGZwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFBmcC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy9IYW5kbGVyXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZCkge1xyXG4gIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XHJcbiAgY29uZmlybVBvcHVwLmhhbmRsZUNvbmZpcm0oKCkgPT4ge1xyXG4gICAgY29uZmlybVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRDYXJkSWQoKSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIGNvbmZpcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vc3VibWl0IGZ1bmN0aW9uXHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBwb3B1cEluc3RhbmNlLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBwb3B1cEluc3RhbmNlLnJlbmRlckxvYWRpbmcodHJ1ZSwgbG9hZGluZ1RleHQpO1xyXG4gIHJlcXVlc3QoKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBwb3B1cEluc3RhbmNlLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZWRpdFByb2ZpbGVTdWJtaXQodXNlckRhdGEpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGkuZWRpdFVzZXJEYXRhKHVzZXJEYXRhKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5tb2RpZnlVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBwcm9maWxlUG9wdXApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBlZGl0UGZwU3VibWl0KHVzZXJEYXRhKSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmVkaXRQZnAodXNlckRhdGEpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJQZnAoeyBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhciB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRQZnApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGROZXdDYXJkU3VibWl0KGRhdGEpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGkuYWRkTmV3Q2FyZChkYXRhKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIGZvcm1WYWxpZGF0b3JzW1wibmV3Y2FyZC1mb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIG5ld0NhcmRQb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGNhcmQpIHtcclxuICBpZiAoY2FyZC5nZXRJc0xpa2VkKCkpIHtcclxuICAgIGFwaVxyXG4gICAgICAucmVtb3ZlTGlrZShjYXJkLmdldENhcmRJZCgpKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5zZXRJc0xpa2VkKGZhbHNlKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZExpa2UoY2FyZC5nZXRDYXJkSWQoKSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuc2V0SXNMaWtlZCh0cnVlKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH1cclxufVxyXG5cclxuLy92YWxpZGF0aW9uXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiaWRcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19pbWFnZS1wcmV2aWV3XCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2VUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fdGl0bGUtcHJldmlld1wiXHJcbiAgICApO1xyXG4gIH1cclxuICBvcGVuKG5hbWUgPSBcIlwiLCBsaW5rID0gXCJcIikge1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZVRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX3NhdmUtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ29uZmlybShhcGlDbGljaykge1xyXG4gICAgdGhpcy5faGFuZGxlQ29uZmlybVN1Ym1pdCA9IGFwaUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgb3BlbihjdXJyZW50Q2FyZCwgY2FyZElkKSB7XHJcbiAgICB0aGlzLl9jdXJyZW50Q2FyZCA9IGN1cnJlbnRDYXJkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlQ29uZmlybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJMb2FkaW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIllFU1wiO1xyXG4gICAgfVxyXG4gIH1cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VyRGF0YSh1c2VyRGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRQZnAodXNlckRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IHVzZXJEYXRhLmxpbmsgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGNhcmREYXRhLm5hbWUsXHJcbiAgICAgICAgbGluazogY2FyZERhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmREYXRhfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcihwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwZnBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fZGlzcGxheWVkTmFtZSA9IHByb2ZpbGVOYW1lO1xyXG4gICAgdGhpcy5fZGlzcGxheWVkRGVzY3JpcHRpb24gPSBwcm9maWxlRGVzY3JpcHRpb247XHJcbiAgICB0aGlzLl9wZnBFbGVtZW50ID0gcGZwU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX2Rpc3BsYXllZE5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kaXNwbGF5ZWREZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gICAgdGhpcy5fZGlzcGxheWVkTmFtZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9kaXNwbGF5ZWREZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgbW9kaWZ5VXNlckluZm8odXNlckRhdGEpIHtcclxuICAgIHRoaXMuX2Rpc3BsYXllZE5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fZGlzcGxheWVkRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJQZnAodXNlckRhdGEpIHtcclxuICAgIHRoaXMuX3BmcEVsZW1lbnQuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlckl0ZW1zKGl0ZW0pIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICAgIC8vY3JlYXRlIGVsZW1lbnRzIHRvIHJlbmRlclxyXG4gIH1cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucHJlcGVuZChlbGVtZW50KTtcclxuICAgIC8vIGFkZCBpdGVtIGludG8gdGhpcy5fZWxlbWVudFxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNhcmQiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiaWQiLCJfaWQiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQ2FyZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsImdldENhcmRJZCIsImdldElzTGlrZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsInNldElzTGlrZWQiLCJfcmVuZGVyTGlrZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiZGlzYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJidXR0b24iLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRFbHMiLCJmb3JFYWNoIiwiaW5wdXRMaXN0IiwiX2hhc1ZhbGlkSW5wdXQiLCJldmVyeSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dEVsIiwiZXZ0IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXQiLCJwcm9maWxlRWRpdEJ0biIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiY2FyZEFkZEJ0biIsImZvcm1WYWxpZGF0b3JzIiwicGZwIiwiaW1hZ2VQb3B1cCIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld0ltYWdlVGl0bGUiLCJwcm9maWxlUG9wdXAiLCJ1c2VyRGF0YSIsImhhbmRsZVN1Ym1pdCIsImFwaSIsImVkaXRVc2VyRGF0YSIsInRoZW4iLCJ1c2VySW5mbyIsIm1vZGlmeVVzZXJJbmZvIiwibmV3Q2FyZFBvcHVwIiwiYWRkTmV3Q2FyZCIsImNyZWF0ZUNhcmQiLCJlZGl0UGZwIiwic2V0VXNlclBmcCIsImF2YXRhciIsImNvbmZpcm1Qb3B1cCIsImhhbmRsZUNvbmZpcm0iLCJhcGlDbGljayIsIl9oYW5kbGVDb25maXJtU3VibWl0IiwiY3VycmVudENhcmQiLCJjYXJkSWQiLCJfY3VycmVudENhcmQiLCJfY2FyZElkIiwic2hvd0xvYWRpbmciLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJnZXRVc2VyRGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImNhcmREYXRhIiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJkZWxldGVDYXJkIiwiYXV0aG9yaXphdGlvbiIsInBmcFNlbGVjdG9yIiwiX2Rpc3BsYXllZE5hbWUiLCJfZGlzcGxheWVkRGVzY3JpcHRpb24iLCJfcGZwRWxlbWVudCIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJjYXJkRWxlbWVudCIsImhhbmRsZUNhcmRJbWFnZUNsaWNrIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwibWFwIiwicmVuZGVySXRlbXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9lbGVtZW50IiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZCIsImZpbmFsbHkiLCJyZXF1ZXN0IiwicG9wdXBJbnN0YW5jZSIsImluZm8iLCJ2YWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9